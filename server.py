"""
Facebook Scraper3 MCP Server

使用 FastMCP 的 from_openapi 方法自动生成

Version: 1.0.0
Transport: stdio
"""
import os
import json
import httpx
from fastmcp import FastMCP

# 服务器版本和配置
__version__ = "1.0.0"
__tag__ = "facebook_scraper3/1.0.0"

# API 配置
API_KEY = os.getenv("API_KEY", "")

# 传输协议配置
TRANSPORT = "stdio"


# OpenAPI 规范
OPENAPI_SPEC = """{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"Facebook Scraper3\",\n    \"version\": \"1.0.0\",\n    \"description\": \"RapidAPI: krasnoludkolo/facebook-scraper3\"\n  },\n  \"servers\": [\n    {\n      \"url\": \"https://facebook-scraper3.p.rapidapi.com\"\n    }\n  ],\n  \"paths\": {\n    \"/comment\": {\n      \"get\": {\n        \"summary\": \"comment by id\",\n        \"description\": \"Get comment by comment id\",\n        \"operationId\": \"comment_by_id\",\n        \"parameters\": [\n          {\n            \"name\": \"comment_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2815848835278004\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/people\": {\n      \"get\": {\n        \"summary\": \"Search people\",\n        \"description\": \"Searches people\",\n        \"operationId\": \"search_people\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: pizza\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/hashtags\": {\n      \"get\": {\n        \"summary\": \"Search hashtag\",\n        \"description\": \"Search posts with hashtag\",\n        \"operationId\": \"search_hashtag\",\n        \"parameters\": [\n          {\n            \"name\": \"hashtag\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: gol\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/profile/reels\": {\n      \"get\": {\n        \"summary\": \"Profile reels\",\n        \"description\": \"Get profile reels. Get `reels_profile_id` from profile details endpoint\",\n        \"operationId\": \"profile_reels\",\n        \"parameters\": [\n          {\n            \"name\": \"reels_profile_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: YXBwX2NvbGxlY3Rpb246cGZiaWQwUHNSMVVqTTE3a2dicGQ1VVkycEhwcGtKV2dwOFltNHpxUU53U3JCRTluUUZmQ3o0dG9tMjNLaWlTVnNzZmpNQnlDWVoxQWtjTXNlVmlveWdFeGw=\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/events/future\": {\n      \"get\": {\n        \"summary\": \"Page events\",\n        \"description\": \"Get all future events created by page\",\n        \"operationId\": \"page_events\",\n        \"parameters\": [\n          {\n            \"name\": \"page_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 100063667778486\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"collection_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/post/reactions\": {\n      \"get\": {\n        \"summary\": \"Post reactions\",\n        \"description\": \"Get post reactions\",\n        \"operationId\": \"post_reactions\",\n        \"parameters\": [\n          {\n            \"name\": \"post_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2253766361810327\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/post/comments_nested\": {\n      \"get\": {\n        \"summary\": \"comments - nested\",\n        \"description\": \"Get nested comments. You need to use legacy fb id\",\n        \"operationId\": \"comments___nested\",\n        \"parameters\": [\n          {\n            \"name\": \"post_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 979891387516215\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"comment_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"legacy_comment_id\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"expansion_token\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: MjoxNzM3OTY2Mzk0OgF1awP-xdBTo30UnnZUyhtyeebg0jVPoVV4mPROM1cOYWTDR5SCnvo6iBi20bz8LOYiG8vLdH6MB7q-43BaIT4TuTSDOaTc6RuXysoOhSqAVJA0_WcLrgUn8XQK-RiWnu1_pzCvCo8quhTgHDUvkAVRvV-Cun1kyY3xbgsW_43rvGoObIdFqDsduFTaPu2H440xn6U9b0uKIG7HEVDuTPkjF-KUBds0l_m3DiKRhCA4frRbr1vbRG6f2Mbf4nw4yhKhjIHFe9CTXpYlvZAVf6LqF84O2167FRMyOWSR1x1YIBURLRSRL_azSdTcpPHVV3E_fUzb3nXT3aq7I3TLeHqPJp2kAU-bCas-Tq_BjcK1mQbFUPBR9R0LpNGaNRMMdFwkCouRuvktHEZa1-6maYUw\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/reels\": {\n      \"get\": {\n        \"summary\": \"Page reels\",\n        \"description\": \"Get page reels by page id - use reels_page_id now\",\n        \"operationId\": \"page_reels\",\n        \"parameters\": [\n          {\n            \"name\": \"page_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"legacy - migrate to reels_page_id\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"reels_page_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Value used by facebook. Get it from page details endpoint\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/marketplace/details\": {\n      \"get\": {\n        \"summary\": \"Listing details\",\n        \"description\": \"Get listing details\",\n        \"operationId\": \"listing_details\",\n        \"parameters\": [\n          {\n            \"name\": \"listing_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 750003161080442\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/marketplace/search\": {\n      \"get\": {\n        \"summary\": \"Search\",\n        \"description\": \"Search marketplace. Use cursor to get next page\",\n        \"operationId\": \"search\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: pizza\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 40.7128\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": \"40.7128\",\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lng\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: -74.006\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": \"-74.006\",\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"price_min\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": \"0\",\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"price_max\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": \"0\",\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"radius_km\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": \"0\",\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"condition\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"used_like_new , used_good, used_fair , new Can be combined with coma, for example: used_like_new,used_good\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"category\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"cars, boats etc.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/post/comments\": {\n      \"get\": {\n        \"summary\": \"comments\",\n        \"description\": \"Get post comments. Use comment_id from post\",\n        \"operationId\": \"comments\",\n        \"parameters\": [\n          {\n            \"name\": \"post_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: pfbid02BzYRNmoznsZjci5FuztPUb9mKd9ameNVYSBweaBEvb8oEzSMjcs8nbXnMkYA5Benl\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/groups_posts\": {\n      \"get\": {\n        \"summary\": \"Search groups posts\",\n        \"description\": \"Searches group for posts\",\n        \"operationId\": \"search_groups_posts\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: Be my friend\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"group_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 137206643664121\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/videos\": {\n      \"get\": {\n        \"summary\": \"Page videos\",\n        \"description\": \"Get page videos by page delegate id.  YOU NEED TO USE DELEGATE ID, NOT PAGE ID.\",\n        \"operationId\": \"page_videos\",\n        \"parameters\": [\n          {\n            \"name\": \"delegate_page_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 20531316728\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/photos\": {\n      \"get\": {\n        \"summary\": \"Pages photos\",\n        \"description\": \"Read page photos (from recent)  Use cursor to get next page of results\",\n        \"operationId\": \"pages_photos\",\n        \"parameters\": [\n          {\n            \"name\": \"page_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 100064830872783\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"collection_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Required with cursor. Obtain from first response\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/posts\": {\n      \"get\": {\n        \"summary\": \"Pages posts\",\n        \"description\": \"Read page posts (from recent)\",\n        \"operationId\": \"pages_posts\",\n        \"parameters\": [\n          {\n            \"name\": \"page_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 100064860875397\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/details\": {\n      \"get\": {\n        \"summary\": \"Page details\",\n        \"description\": \"Read page details\",\n        \"operationId\": \"page_details\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: https://www.facebook.com/facebook\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/events/past\": {\n      \"get\": {\n        \"summary\": \"Page past events\",\n        \"description\": \"Get all past events created by page. Use cursor to get next page of results.\",\n        \"operationId\": \"page_past_events\",\n        \"parameters\": [\n          {\n            \"name\": \"page_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 100063667778486\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"collection_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/group/posts\": {\n      \"get\": {\n        \"summary\": \"get group posts\",\n        \"description\": \"Get group posts.  Only PUBLIC groups can be scrapped! If there are no post response, check if group is not private.\",\n        \"operationId\": \"get_group_posts\",\n        \"parameters\": [\n          {\n            \"name\": \"group_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 1439220986320043\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"sorting_order\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/group/future_events\": {\n      \"get\": {\n        \"summary\": \"get group future events\",\n        \"description\": \"Get group future events.  Only PUBLIC groups can be scrapped! If there are no post response, check if group is not private. Use cursor to get next page of events!\",\n        \"operationId\": \"get_group_future_events\",\n        \"parameters\": [\n          {\n            \"name\": \"group_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 1571965316444595\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/events\": {\n      \"get\": {\n        \"summary\": \"Search events\",\n        \"description\": \"Searches for facebook events\",\n        \"operationId\": \"search_events\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: beer\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"location_uid\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/gaming/live\": {\n      \"get\": {\n        \"summary\": \"Game lives\",\n        \"description\": \"Get game live videos Use cursor to get next page.\",\n        \"operationId\": \"game_lives\",\n        \"parameters\": [\n          {\n            \"name\": \"game_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 1494097103958822\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"sort_order\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/gaming/games\": {\n      \"get\": {\n        \"summary\": \"Browse games\",\n        \"description\": \"Browse games.  Use empty query for browse all games. Use cursor to get next page.\",\n        \"operationId\": \"browse_games\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value:  \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"sort_order\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/reviews\": {\n      \"get\": {\n        \"summary\": \"Page reviews\",\n        \"description\": \"Get page reviews. Use cursor to get next page\",\n        \"operationId\": \"page_reviews\",\n        \"parameters\": [\n          {\n            \"name\": \"page_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 100063543614476\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/videos\": {\n      \"get\": {\n        \"summary\": \"Search video\",\n        \"description\": \"Performs facebook videos search\",\n        \"operationId\": \"search_video\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: facebook\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"recent_videos\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"location_uid\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/profile/posts\": {\n      \"get\": {\n        \"summary\": \"Profile posts\",\n        \"description\": \"Read profile posts (from recent), if public\",\n        \"operationId\": \"profile_posts\",\n        \"parameters\": [\n          {\n            \"name\": \"profile_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 4\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/event/details_id\": {\n      \"get\": {\n        \"summary\": \"Events details by id\",\n        \"description\": \"Get events details by event id\",\n        \"operationId\": \"events_details_by_id\",\n        \"parameters\": [\n          {\n            \"name\": \"event_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 1259800548576578\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/locations\": {\n      \"get\": {\n        \"summary\": \"locations\",\n        \"description\": \"Search for facebook locations id. If you get strange results, try add country to query and/or try without diacritic\",\n        \"operationId\": \"locations\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/posts\": {\n      \"get\": {\n        \"summary\": \"Search post\",\n        \"description\": \"Performs facebook posts search\",\n        \"operationId\": \"search_post\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: facebook\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"recent_posts\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"location_uid\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end_date\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/event/details\": {\n      \"get\": {\n        \"summary\": \"Events details by url\",\n        \"description\": \"Get events details\",\n        \"operationId\": \"events_details_by_url\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: https://www.facebook.com/events/456725590572335\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/profile/details_id\": {\n      \"get\": {\n        \"summary\": \"Profiles details by id\",\n        \"description\": \"Get profiles details by id\",\n        \"operationId\": \"profiles_details_by_id\",\n        \"parameters\": [\n          {\n            \"name\": \"profile_id\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/profile/details_url\": {\n      \"get\": {\n        \"summary\": \"Profile details by url\",\n        \"description\": \"Get profile details by url\",\n        \"operationId\": \"profile_details_by_url\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/profile/profile_id\": {\n      \"get\": {\n        \"summary\": \"Profile id\",\n        \"description\": \"Get profile id by url\",\n        \"operationId\": \"profile_id\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/post\": {\n      \"get\": {\n        \"summary\": \"get post details\",\n        \"description\": \"Get post details by url or post id. If both are set, post id is used.\",\n        \"operationId\": \"get_post_details\",\n        \"parameters\": [\n          {\n            \"name\": \"post_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: pfbid04KTWEM9Rri6Wg3oLRBF5FUUvfPebQ6ZJRwVivymc8e8KWvy3RsnpUXyppjEZqkwZl\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"post_url\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/group/details\": {\n      \"get\": {\n        \"summary\": \"get group details\",\n        \"description\": \"Get group summary\",\n        \"operationId\": \"get_group_details\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: https://www.facebook.com/groups/gieldagryplanszowe\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/group/id\": {\n      \"get\": {\n        \"summary\": \"get group id\",\n        \"description\": \"Getting group facebook id\",\n        \"operationId\": \"get_group_id\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: https://www.facebook.com/groups/gieldagryplanszowe\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/page/page_id\": {\n      \"get\": {\n        \"summary\": \"Page id\",\n        \"description\": \"get page id from url\",\n        \"operationId\": \"page_id\",\n        \"parameters\": [\n          {\n            \"name\": \"url\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: https://facebook.com/facebook\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/post/share\": {\n      \"get\": {\n        \"summary\": \"reshares\",\n        \"description\": \"Get post reshares\",\n        \"operationId\": \"reshares\",\n        \"parameters\": [\n          {\n            \"name\": \"post_id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"use share_id from post details\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/places\": {\n      \"get\": {\n        \"summary\": \"Search place\",\n        \"description\": \"Search for fb place\",\n        \"operationId\": \"search_place\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: pizza\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"location_uid\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/search/pages\": {\n      \"get\": {\n        \"summary\": \"Search pages\",\n        \"description\": \"Searches for facebook pages\",\n        \"operationId\": \"search_pages\",\n        \"parameters\": [\n          {\n            \"name\": \"query\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: beer\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"cursor\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"location_uid\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  \"components\": {\n    \"securitySchemes\": {\n      \"ApiAuth\": {\n        \"type\": \"apiKey\",\n        \"in\": \"header\",\n        \"name\": \"X-RapidAPI-Key\"\n      }\n    }\n  },\n  \"security\": [\n    {\n      \"ApiAuth\": []\n    }\n  ]\n}"""

# 创建 HTTP 客户端
# 设置默认 headers
default_headers = {}


# RapidAPI 必需的 headers
if API_KEY:
    default_headers["X-RapidAPI-Key"] = API_KEY
    default_headers["X-RapidAPI-Host"] = "facebook-scraper3.p.rapidapi.com"
else:
    print("⚠️  警告: 未设置 API_KEY 环境变量")
    print("   RapidAPI 需要 API Key 才能正常工作")
    print("   请设置: export API_KEY=你的RapidAPI-Key")

# 对于 POST/PUT/PATCH 请求，自动添加 Content-Type
default_headers["Content-Type"] = "application/json"




client = httpx.AsyncClient(
    base_url="https://facebook-scraper3.p.rapidapi.com", 
    timeout=30.0
)


# 从 OpenAPI 规范创建 FastMCP 服务器
openapi_dict = json.loads(OPENAPI_SPEC)
mcp = FastMCP.from_openapi(
    openapi_spec=openapi_dict,
    client=client,
    name="facebook_scraper3",
    version=__version__
)


# 注册请求拦截器，为所有请求添加 RapidAPI headers
_original_request = client.request

async def _add_rapidapi_headers(method, url, **kwargs):
    """拦截所有请求，添加必需的 RapidAPI headers"""
    # 确保 headers 存在
    if 'headers' not in kwargs:
        kwargs['headers'] = {}
    
    # 添加 RapidAPI 必需的 headers
    if API_KEY:
        kwargs['headers']['X-RapidAPI-Key'] = API_KEY
        kwargs['headers']['X-RapidAPI-Host'] = "facebook-scraper3.p.rapidapi.com"
    else:
        print("⚠️  警告: API_KEY 未设置，请求可能失败")
    
    # 对于 POST/PUT/PATCH，添加 Content-Type
    if method.upper() in ['POST', 'PUT', 'PATCH']:
        if 'Content-Type' not in kwargs['headers']:
            kwargs['headers']['Content-Type'] = 'application/json'
    
    return await _original_request(method, url, **kwargs)

# 替换 request 方法
client.request = _add_rapidapi_headers


def main():
    """主入口点"""
    print(f"🚀 启动 Facebook Scraper3 MCP 服务器")
    print(f"📦 版本: {__tag__}")
    print(f"🔧 传输协议: {TRANSPORT}")
    
    print()
    
    # 运行服务器
    
    mcp.run(transport="stdio")
    


if __name__ == "__main__":
    main()